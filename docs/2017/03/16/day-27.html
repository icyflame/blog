<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <meta content="https://icyflame.github.io/dp.jpg" property="og:image">

  <meta content="Siddharth Kannan's Blog" property="og:site_name">

  
  <meta content="Day 27 - MISSED; Some python and regex written for Gyft" property="og:title">
  

  
  <meta content="article" property="og:type">
  

  
  <meta content="513 words about writing" property="og:description">
  

  
  <meta content="https://blog.siddharthkannan.in/2017/03/16/day-27" property="og:url">
  

  
  <meta content="2017-03-16T00:00:00+00:00" property="article:published_time">
  <meta content="https://blog.siddharthkannan.in/about/" property="article:author">
  

  
  
  <meta content="100daysofwriting" property="article:section">
  
  

  
  
  

  <title>
    
    Day 27 - MISSED; Some python and regex written for Gyft &middot; Siddharth Kannan's Blog
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="https://blog.siddharthkannan.in/public/css/poole.css">
  <link rel="stylesheet" href="https://blog.siddharthkannan.in/public/css/syntax.css">
  <link rel="stylesheet" href="https://blog.siddharthkannan.in/public/css/hyde.css">
  <link rel="stylesheet" href="https://blog.siddharthkannan.in/public/css/custom.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="https://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://blog.siddharthkannan.in/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="https://blog.siddharthkannan.in/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Google Adsense -->
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
	(adsbygoogle = window.adsbygoogle || []).push({
		google_ad_client: "ca-pub-1148465602033451",
		enable_page_level_ads: true
	});
  </script>
</head>


  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h2>
        <a href="https://blog.siddharthkannan.in/">
          Siddharth Kannan's Blog
        </a>
      </h2>
      <p class="lead">Programmer | Pianist <br/><a href="http://icyflame.github.io">@icyflame</a></p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="https://blog.siddharthkannan.in/">Home</a>

      

      
      
        
          
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="https://blog.siddharthkannan.in/about">About</a>
            <!-- about -->
          
        
      
        
          
            <a class="sidebar-nav-item" href="https://blog.siddharthkannan.in/list">List of Posts</a>
            <!-- list -->
          
        
      
        
          
            <a class="sidebar-nav-item" href="https://blog.siddharthkannan.in/tag/">List of Posts by Tag</a>
            <!-- tag/ -->
          
        
      
        
          
            <a class="sidebar-nav-item" href="https://blog.siddharthkannan.in/series">List of Series</a>
            <!-- series -->
          
        
      
        
          
            <a class="sidebar-nav-item" href="https://blog.siddharthkannan.in/rss">RSS</a>
            <!-- rss -->
          
        
      

      <span class="sidebar-nav-item">Powered by <a href="https://jekyllrb.com">Jekyll</a>
			  and <a href="https://github.com/poole/hyde">Hyde</a></span>
      <span class="sidebar-nav-item">Hosted on <a href="https://github.com">Github</a></span>
    </nav>

    <p>&copy; 2024. All rights reserved.</p>
  </div>
</div>


    <div class="content container-fluid">
      <div class="post">
  <h1 class="post-title">Day 27 - MISSED; Some python and regex written for Gyft</h1>
  <span class="post-date">16 Mar 2017</span>

  
  <span class="post-date">
  

  
  <a href="https://blog.siddharthkannan.in/tag/#100daysofwriting">
    100daysofwriting
  </a>
  
    &middot;
  
  
  <a href="https://blog.siddharthkannan.in/tag/#late-post">
    late-post
  </a>
  
    &middot;
  
  
  <a href="https://blog.siddharthkannan.in/tag/#writing">
    writing
  </a>
  
  
</span>


  
  <p>ARGH! I missed yesterday. It wasn’t even too tiring a day or anything, anyway, I
am going to make the best of this. I am about 8 hours later than when the usual
post should have been.</p>

<p>I have not been writing a lot of code, and I hadn’t submitted a pull request in
almost 20 days! <em>That’s unacceptable, Jimmy, UNACCEPTABLE.</em></p>

<p><img src="/public/img/day-27-1.png" alt="img" /></p>

<p>I decided to remedy that situation today. Gyft is a set of python scripts which
lets you login into your IIT Kharagpur ERP account, get your timetable for the
semester from there. Before my patch, the only option was to put this timetable
into your Google Calendar. You generate a <code class="language-plaintext highlighter-rouge">client_secret</code> file and give the
python script access to add recurring events to your calendar. It didn’t sound
right to me, and it was pretty cumbersome to use as well.</p>

<p>So, I wanted to enable exporting the calendar to ICS files. ICS files are
amazing! Every major calendar application supports them, they are apt for static
calendars like a Semester timetable. I had this idea in <a href="https://github.com/icyflame/gyft/commit/4bf76fd2633870f274a1b952ea66abac63339fb9">August
2016</a>,
I opened <a href="https://github.com/metakgp/gyft/issues/24">the issue</a> in December 2016. 
Since, it has just been vegetating because I wasn’t working on it, and the
whole Gyft repository has been <a href="https://github.com/metakgp/gyft/graphs/commit-activity">rather
inactive</a> since.</p>

<p>The first part of the patch that I had implemented already was the relatively
time-consuming part. It had a function which would build an event given the
<a href="https://github.com/icyflame/gyft/commit/4bf76fd2633870f274a1b952ea66abac63339fb9#diff-b284a28710cce90d9d9be3a7f4cabc8eR9">appropriate
parameters</a>
like start time, end time, etc.</p>

<p>The second part of this patch was to merge this with the parsing code that is
there inside the <code class="language-plaintext highlighter-rouge">add_events.py</code> script. It takes the data from the <code class="language-plaintext highlighter-rouge">data.txt</code>
file (which is taken from the ERP) and parses that into event information.</p>

<p>Here comes the Regular Expressions part. The old parsing was done with
a complicated <a href="https://github.com/metakgp/gyft/blob/bf3c2614d8508706f30bedca9419b6bf3dac2e33/add_events.py#L88-L129">string parsing mechanism</a>.
Frankly, I couldn’t understand what was being done, and I took a step back and
analysed the string that we do want to parse. It looks something like this:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10:0:AM-10:55:AM
</code></pre></div></div>

<p>I realised that this was the best place to use Regular Expressions! A couple of
minutes in the Python shell led me to this regular expression:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TIMETABLE_DICT_RE <span class="o">=</span><span class="s1">'([0-9]{1,2}):([0-9]{1,2}):([AP])M-([0-9]{1,2}):([0-9]{1,2}):([AP])M'</span>
</code></pre></div></div>

<p>This Regex is clearly not optimal, there is no need to repeat the same Regular
Expression twice. Having it only once, should be enough. I should implement
that!</p>

<p>But barring that, it worked out pretty well. The new parsing code which is part
of the new <code class="language-plaintext highlighter-rouge">generate_ics.py</code> script was
<a href="https://github.com/icyflame/gyft/blob/3e761cd3e2017ee2d876819df401df9dc791b24d/generate_ics.py#L89-L95">smaller</a>
and also returned a <code class="language-plaintext highlighter-rouge">datetime</code> object instead of trying to write the complete
iCalendar event as per the <a href="https://tools.ietf.org/html/rfc5545">RFC (IETF RFC 5545)</a>.</p>

<p>Eventually, <a href="https://github.com/metakgp/gyft/pull/32">this pull request</a>
came out of my work today! I am awaiting reviews
on the pull request, and it should get merged soon. I have already generated an
ICS and added it to my Google Calendar! It looks good!</p>

<p><img src="/public/img/day-27-2.png" alt="img" /></p>

<p><strong>POST #27 is OVER</strong></p>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
    <li>
      <h3>
        <a href="https://blog.siddharthkannan.in/2024/08/31/wireguard-and-mtu-adventure">
          Adventures with Wireguard and MTU
          <small>31 Aug 2024</small>
        </a>
      </h3>
    </li>
    
    <li>
      <h3>
        <a href="https://blog.siddharthkannan.in/2024/08/29/using-iphone-without-windows-or-apple">
          Using an iPhone Without Windows or Apple Computers
          <small>29 Aug 2024</small>
        </a>
      </h3>
    </li>
    
    <li>
      <h3>
        <a href="https://blog.siddharthkannan.in/2024/06/12/book-review-delillo-white-noise">
          Notes and Review - White Noise (DeLillo)
          <small>12 Jun 2024</small>
        </a>
      </h3>
    </li>
    
  </ul>
</div>

<!-- Disqus Thread -->

<div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'siddharthkannanblog'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <!-- <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a> -->

    </div>

    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YE2VZMP9F1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YE2VZMP9F1');
</script>


  </body>
</html>
