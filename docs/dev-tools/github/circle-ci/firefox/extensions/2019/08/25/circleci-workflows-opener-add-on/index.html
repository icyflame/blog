<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <meta content="https://icyflame.github.io/dp.jpg" property="og:image">

  <meta content="Siddharth Kannan's Blog" property="og:site_name">

  
  <meta content="Firefox Add-on to jump from GitHub to CircleCI extremely fast!" property="og:title">
  

  
  <meta content="article" property="og:type">
  

  
  <meta content="1116 words about github" property="og:description">
  

  
  <meta content="https://blog.siddharthkannan.in/dev-tools/github/circle-ci/firefox/extensions/2019/08/25/circleci-workflows-opener-add-on/" property="og:url">
  

  
  <meta content="2019-08-25T00:00:00+00:00" property="article:published_time">
  <meta content="https://blog.siddharthkannan.in/about/" property="article:author">
  

  
  
  <meta content="dev-tools" property="article:section">
  
  

  
  
  

  <title>
    
    Firefox Add-on to jump from GitHub to CircleCI extremely fast! &middot; Siddharth Kannan's Blog
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="https://blog.siddharthkannan.in/public/css/poole.css">
  <link rel="stylesheet" href="https://blog.siddharthkannan.in/public/css/syntax.css">
  <link rel="stylesheet" href="https://blog.siddharthkannan.in/public/css/hyde.css">
  <link rel="stylesheet" href="https://blog.siddharthkannan.in/public/css/custom.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="https://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://blog.siddharthkannan.in/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="https://blog.siddharthkannan.in/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Google Adsense -->
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
	(adsbygoogle = window.adsbygoogle || []).push({
		google_ad_client: "ca-pub-1148465602033451",
		enable_page_level_ads: true
	});
  </script>
</head>


  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h2>
        <a href="https://blog.siddharthkannan.in/">
          Siddharth Kannan's Blog
        </a>
      </h2>
      <p class="lead">Programmer | Pianist <br/><a href="http://icyflame.github.io">@icyflame</a></p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="https://blog.siddharthkannan.in/">Home</a>

      

      
      
        
          
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="https://blog.siddharthkannan.in/about/">About</a>
            <!-- about/ -->
          
        
      
        
          
            <a class="sidebar-nav-item" href="https://blog.siddharthkannan.in/list/">List of Posts</a>
            <!-- list/ -->
          
        
      
        
          
            <a class="sidebar-nav-item" href="https://blog.siddharthkannan.in/tag/">List of Posts by Tag</a>
            <!-- tag/ -->
          
        
      
        
          
            <a class="sidebar-nav-item" href="https://blog.siddharthkannan.in/series">List of Series</a>
            <!-- series -->
          
        
      
        
          
            <a class="sidebar-nav-item" href="https://blog.siddharthkannan.in/rss/">RSS</a>
            <!-- rss/ -->
          
        
      

      <span class="sidebar-nav-item">Powered by <a href="https://jekyllrb.com">Jekyll</a>
			  and <a href="https://github.com/poole/hyde">Hyde</a></span>
      <span class="sidebar-nav-item">Hosted on <a href="https://github.com">Github</a></span>
    </nav>

    <p>&copy; 2024. All rights reserved.</p>
  </div>
</div>


    <div class="content container-fluid">
      <div class="post">
  <h1 class="post-title">Firefox Add-on to jump from GitHub to CircleCI extremely fast!</h1>
  <span class="post-date">25 Aug 2019</span>

  
  <span class="post-date">
  

  
  <a href="https://blog.siddharthkannan.in/tag/#circle-ci">
    circle-ci
  </a>
  
    &middot;
  
  
  <a href="https://blog.siddharthkannan.in/tag/#dev-tools">
    dev-tools
  </a>
  
    &middot;
  
  
  <a href="https://blog.siddharthkannan.in/tag/#extensions">
    extensions
  </a>
  
    &middot;
  
  
  <a href="https://blog.siddharthkannan.in/tag/#firefox">
    firefox
  </a>
  
    &middot;
  
  
  <a href="https://blog.siddharthkannan.in/tag/#github">
    github
  </a>
  
  
</span>


  
  <h2 id="what">What?</h2>

<p>I use GitHub and CircleCI at work. One of the most common workflows for me, is
to merge a PR, click on the repository name to go to the repo page, scroll down
to the Readme and click on the CircleCI indicator to check the status of the CI
job kicked by the merge.</p>

<p>When the CI workflow is done and completes successfully, I go back to the repo
page and click on “Releases”, create a new release (a Git tag) and then again go
to the readme to go back and wait for the Release CI to finish.</p>

<p>Once that is done, I open Spinnaker and wait some more for that to get
triggered. For some reason, <a href="https://www.spinnaker.io/concepts/">Spinnaker</a> takes about 10 minutes to detect that
a new image with a tag matching a provided regex was pushed to GCR.</p>

<!--more-->

<p>In any case, you might have noticed that I switch between GitHub and CircleCI a
lot. Now, most repositories at work have a CircleCI indicator at the top. If
they don’t, there’s always the option to open a PR and wait for someone to
approve it and then you can finally merge it. But this whole process was
extremely annoying to me, because there’s no <em>need</em> for this indicator.</p>

<p>You see, the link patterns are fixed and extremely easy to generate using just
regex!</p>

<p>GitHub:   <code class="language-plaintext highlighter-rouge">https://github.com/username/repository/.*</code>
CircleCI: <code class="language-plaintext highlighter-rouge">https://circleci.com/gh/username/repository/</code></p>

<p>So, all you really need to do is replace the beginning and remove anything after
the end of the repository name: that’s a textbook usecase for a bookmarklet with
JavaScript!</p>

<h2 id="why-not-a-bookmarklet">Why <em>not</em> a bookmarklet?</h2>

<p>So, I wrote a bookmarklet. Very short and sweet!</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">javascript</span><span class="p">:</span>
<span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">;</span>
<span class="k">if </span><span class="p">(</span><span class="nx">url</span><span class="p">.</span><span class="nf">match</span><span class="p">(</span><span class="sr">/https:</span><span class="se">\/\/</span><span class="sr">github.com</span><span class="se">\/</span><span class="sr">/</span><span class="p">))</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">baseRemoved</span> <span class="o">=</span> <span class="nx">url</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://github.com/</span><span class="dl">'</span><span class="p">,</span> <span class="dl">''</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">components</span> <span class="o">=</span> <span class="nx">baseRemoved</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">components</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">account</span> <span class="o">=</span> <span class="nx">components</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">repo</span> <span class="o">=</span> <span class="nx">components</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">newURL</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://circleci.com/gh/</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">account</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">/</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">repo</span><span class="p">;</span>
        <span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">newURL</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>I add it into a bookmark and click it. Nothing happens. The console shows me an
error that sort-of tells me something useful, but not really:</p>

<p><img src="/public/img/github-bookmarklet-image.png" alt="error" /></p>

<p>CSP <a href="https://github.blog/2013-04-19-content-security-policy/#bookmarklets">shouldn’t</a> affect bookmarklets, but it <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=866522">does on Firefox</a>, for the
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1478037">time-being</a> at least. The issue in Firefox that stops the bookmarklet from
running has been going on for nearly 6 years now! That’s an awful lot of time
people have been dealing with this.</p>

<h2 id="the-add-on">The Add-On!</h2>

<p>Extensions have more permissions than a bookmarklet. A user consciously installs
them and they are reviewed before they go on the Firefox add-on store. I started
looking through the <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons">add-on developer documentations</a> to find the right APIs
that I wanted. Originally, I was looking for a keyboard shortcut. But I realized
that that would be tough and that I should stick to doing a clickable element
before aiming higher.</p>

<p>My next plan was to add a fixed HTML element on all GitHub repository pages
which would give me a reliable method to switch from GitHub to CircleCI no
matter which computer I was on. This reliability was particularly important to
me, I wanted the element to be in the same place on all GitHub repository pages.</p>

<p>Turns out the way to do that is something called a <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/pageAction">page action</a>! It looked
perfect for my use-case. It was a button near the address bar. As a cherry on
top, I could <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/commands#Special_shortcuts">connect a keyboard shortcut</a> to it using a <code class="language-plaintext highlighter-rouge">command</code> construct!</p>

<p>The Firefox add-on documentation is extremely good! They have example extensions
which use each JavaScript API that is supported, and for <code class="language-plaintext highlighter-rouge">pageAction</code> it was
<a href="https://github.com/mdn/webextensions-examples/tree/bbacbd0c40eb41622625584355baf077ed598669/apply-css"><code class="language-plaintext highlighter-rouge">apply-css</code></a>. Going through this extension’s <code class="language-plaintext highlighter-rouge">background.js</code> and
<code class="language-plaintext highlighter-rouge">manifest.json</code>, I was able to quickly come up with a dev version.</p>

<p>After that, I cleaned the code up some more, made sure that it had icons and the
other images that were required were present (I used Gimp for a few minutes. By
any designer’s standards, <a href="https://raw.githubusercontent.com/icyflame/open-circleci-workflows-firefox/master/icons/open-circleci-workflows-96.png">this icon</a> is probably hideous)</p>

<p>After pushing the add-on code to GitHub, I created the add-on bundle and
uploaded it to the Firefox store. I did that at 2019-08-24 17:00 JST (UTC+0900).
It’s been 24 hours, and I have gone from spot 22/22 to 5/22 now. I don’t know if
the review is taking longer because it’s the weekend or what.</p>

<p><img src="/public/img/github-bookmarklet-store-review-queue.png" alt="queue-spot" /></p>

<h2 id="bonus-a-chrome-extension-what">Bonus: A Chrome extension! What?!</h2>

<p>Most of my co-workers use Chrome and I have read a little bit about the
WebExtensions API and how it’s a standard and can be used across browsers and
what not. So, I wanted to give it a quick try and see if I could make it work on
Chrome with a few tweaks. It turned out to be fairly easy! The Chrome store
forces on you several severe restrictions:</p>

<ul>
  <li>A 128x128 icon which has 16 transparaent pixels on both sides
    <ul>
      <li>Why must Google force the developer? Surely, they can pad the image once
  it has been uploaded and transform it to whatever size they want as long as
  the aspect ratio is 1:1 (Square)</li>
    </ul>
  </li>
  <li>A 1280x800 screenshot
    <ul>
      <li>Funnily enough, they will NOT accept ANY size except 1280x800. That I find
  very hard to digest because most HD screen-shots are 1920x1020 which can be
  naturally resized to 1280x720. This 1280x800 thing is particularly strange.</li>
      <li>Anyway, I opened up Gimp and used the Align tool to make an image that
  size.</li>
      <li><strong>P.S.</strong> I am really starting to warm up to how useful Gimp has been lately!</li>
    </ul>
  </li>
</ul>

<p>Once, I jumped through those hoops and had the right images, I was able to
submit my add-on and voila, there my extension was! No review process to get
things on the Chrome Extensions store. That would make me squeamish, if I was
using Chrome as my daily-driver and had a couple shady extensions.</p>

<ul>
  <li><a href="https://addons.mozilla.org/en-US/firefox/addon/open-circleci-workflows/">Firefox Add-on</a></li>
  <li><a href="https://chrome.google.com/webstore/detail/open-circleci-workflows/fcjcanbkalgfniilkedfjgaglfgdjlcb">Chrome Extension</a></li>
  <li><a href="https://github.com/icyflame/open-circleci-workflows-firefox">GitHub Repository</a></li>
</ul>

<p><strong>Edit 2019-09-15</strong></p>

<p>Firefox 69 was released a few days ago! Now, bookmarklets to change the URL of a
website <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1478037">work</a>!</p>


</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
    <li>
      <h3>
        <a href="https://blog.siddharthkannan.in/internet/networking/linux/2024/08/31/wireguard-and-mtu-adventure/">
          Adventures with Wireguard and MTU
          <small>31 Aug 2024</small>
        </a>
      </h3>
    </li>
    
    <li>
      <h3>
        <a href="https://blog.siddharthkannan.in/apple/linux/2024/08/29/using-iphone-without-windows-or-apple/">
          Using an iPhone Without Windows or Apple Computers
          <small>29 Aug 2024</small>
        </a>
      </h3>
    </li>
    
    <li>
      <h3>
        <a href="https://blog.siddharthkannan.in/book-review/capitalism/humor/2024/06/12/book-review-delillo-white-noise/">
          Notes and Review - White Noise (DeLillo)
          <small>12 Jun 2024</small>
        </a>
      </h3>
    </li>
    
  </ul>
</div>

<!-- Disqus Thread -->

<div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'siddharthkannanblog'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <!-- <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a> -->

    </div>

    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YE2VZMP9F1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YE2VZMP9F1');
</script>


  </body>
</html>
